@attribute [Route(Routes.ASSISTANT_DYNAMIC)]
@using AIStudio.Tools.PluginSystem.Assistants.DataModel
@inherits AssistantBaseCore<AIStudio.Dialogs.Settings.SettingsDialogDynamic>

@foreach (var component in this.RootComponent!.Children)
{
    @switch (component.Type)
    {
        case AssistantUiCompontentType.TEXT_AREA:
            if (component is AssistantTextArea textArea)
            {
                var lines = textArea.IsSingleLine ? 1 : 6;
                <MudTextField T="string" @bind-Text="@this.inputFields[textArea.Name]" Label="@textArea.Label" ReadOnly="@textArea.ReadOnly" AdornmentIcon="@Icons.Material.Filled.DocumentScanner" Adornment="Adornment.Start" Variant="Variant.Outlined" Lines="@lines" AutoGrow="@true" MaxLines="12" Class="mb-3"/>
            }
            break;
            
        case AssistantUiCompontentType.DROPDOWN:
            if (component is AssistantDropdown assistantDropdown)
            {
                <DynamicAssistantDropdown Items="@assistantDropdown.Items"
                                          @bind-Value="@this.dropdownFields[assistantDropdown.Name]"
                                          Default="@assistantDropdown.Default"
                                          Label="@assistantDropdown.Label"
                                          Icon="@Icons.Material.Filled.Translate"/>
            }
            break;
        case AssistantUiCompontentType.PROVIDER_SELECTION:
            if (component is AssistantProviderSelection providerSelection)
            {
                <ProviderSelection @bind-ProviderSettings="@this.providerSettings" ValidateProvider="@this.ValidatingProvider"/>
            }
            break;
        case AssistantUiCompontentType.SWITCH:
            if (component is AssistantSwitch assistantSwitch)
            {
                <MudTextSwitch Label="@assistantSwitch.Label" @bind-Value="@this.switchFields[assistantSwitch.Name]" LabelOn="@assistantSwitch.LabelOn" LabelOff="@assistantSwitch.LabelOff" />
            }
            break;
        case AssistantUiCompontentType.HEADING:
            if (component is AssistantHeading assistantHeading)
            {
                var heading = assistantHeading;
                @switch (assistantHeading.Level)
                {
                    case 1:
                        <MudText Typo="Typo.h4">@heading.Text</MudText>
                        break;
                    case 2:
                        <MudText Typo="Typo.h5">@heading.Text</MudText>
                        break;
                    case 3:
                        <MudText Typo="Typo.h6">@heading.Text</MudText>
                        break;
                    default:
                        <MudText Typo="Typo.h4">@heading.Text</MudText>
                        break;
                }
            }
            break;
        case AssistantUiCompontentType.TEXT:
            if (component is AssistantText assistantText)
            {
                var text = assistantText;
                <MudText Typo="Typo.body1" Class="mb-3">@text.Content</MudText>
            }
            break;
    }
}